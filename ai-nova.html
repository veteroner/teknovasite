<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Nova - TEKNOVA Yapay Zeka Asistanı</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- AI Nova Özel Ses Sistemi için Web Audio API -->
    <script>
      tailwind.config = {
        darkMode: 'class',
        theme: {
          extend: {
            colors: {
              primary: '#6366f1',
              secondary: '#8b5cf6',
              accent: '#06b6d4',
              dark: '#0f0f23',
              light: '#f8fafc'
            },
            fontFamily: {
              sans: ['Inter', 'ui-sans-serif', 'system-ui'],
            },
            animation: {
              'float': 'float 6s ease-in-out infinite',
              'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
              'typing': 'typing 1s steps(20) infinite',
            },
            keyframes: {
              float: {
                '0%, 100%': { transform: 'translateY(0px)' },
                '50%': { transform: 'translateY(-20px)' },
              },
              typing: {
                '0%': { opacity: '0.4' },
                '50%': { opacity: '1' },
                '100%': { opacity: '0.4' },
              }
            }
          },
        },
      }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
      .gradient-text {
        background: linear-gradient(135deg, #6366f1, #8b5cf6, #06b6d4);
        background-clip: text;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-size: 200% 200%;
        animation: gradient 3s ease infinite;
      }
      
      @keyframes gradient {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
      }
      
      .ai-glow {
        box-shadow: 0 0 20px rgba(99, 102, 241, 0.3);
      }
      
      .chat-bubble {
        animation: slideUp 0.3s ease-out;
      }
      
      @keyframes slideUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      
      .typing-indicator {
        display: inline-block;
        animation: typing 1.5s ease-in-out infinite;
      }
      
      @keyframes typing {
        0%, 60%, 100% {
          transform: scale(1);
          opacity: 0.5;
        }
        30% {
          transform: scale(1.2);
          opacity: 1;
        }
      }
      
      .chat-container {
        height: calc(100vh - 200px);
        max-height: 600px;
      }

      /* Sesli Modal Animasyonları */
      .voice-wave {
        animation: ping 2s cubic-bezier(0, 0, 0.2, 1) infinite;
      }
      
      @keyframes voice-pulse {
        0%, 100% { 
          transform: scale(1);
          box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.7);
        }
        50% { 
          transform: scale(1.1);
          box-shadow: 0 0 0 10px rgba(34, 197, 94, 0);
        }
      }
      
      .voice-recording {
        animation: voice-pulse 1.5s infinite;
      }
    </style>
    <meta name="google-site-verification" content="xb3ywseK2XR4UsVHxRakjZC-eYfdDkPso6QaSZ6QI3A" />
</head>
<body class="bg-light dark:bg-dark text-gray-900 dark:text-gray-100 font-sans transition-colors duration-300">

    
    <!-- Header -->
    <header class="bg-white/95 dark:bg-dark/95 backdrop-blur-md sticky top-0 z-40 shadow-sm border-b border-gray-200 dark:border-gray-800">
      <div class="container mx-auto flex items-center justify-between py-4 px-6">
        <div class="flex items-center gap-3">
          <img src="teknova-logo.png" alt="TEKNOVA Logo" class="w-10 h-10 object-contain rounded-lg shadow" />
          <span class="text-2xl font-bold gradient-text">TEKNOVA</span>
        </div>
        <nav class="hidden md:flex gap-8 text-sm font-medium">
          <a href="index.html" class="hover:text-primary dark:hover:text-accent transition-colors">Ana Sayfa</a>
          <a href="hakkimizda.html" class="hover:text-primary dark:hover:text-accent transition-colors">Hakkımızda</a>
          <a href="cozumlerimiz.html" class="hover:text-primary dark:hover:text-accent transition-colors">AI Çözümlerimiz</a>
          <a href="projeler.html" class="hover:text-primary dark:hover:text-accent transition-colors">Projeler</a>
          <a href="ai-nova.html" class="text-primary dark:text-accent border-b-2 border-primary dark:border-accent">AI Nova</a>
          <a href="iletisim.html" class="hover:text-primary dark:hover:text-accent transition-colors">İletişim</a>
        </nav>
        <div class="md:hidden">
          <button id="mobile-menu-btn" class="text-xl" aria-label="Mobil Menü Aç/Kapat"><i class="fas fa-bars"></i></button>
        </div>
      </div>
      <!-- Mobil Menü -->
      <div id="mobile-menu" class="md:hidden hidden bg-white dark:bg-dark border-t border-gray-200 dark:border-gray-800">
        <div class="container mx-auto py-4 px-6">
          <nav class="flex flex-col gap-4 text-sm font-medium">
            <a href="index.html" class="hover:text-primary dark:hover:text-accent transition-colors">Ana Sayfa</a>
            <a href="hakkimizda.html" class="hover:text-primary dark:hover:text-accent transition-colors">Hakkımızda</a>
            <a href="cozumlerimiz.html" class="hover:text-primary dark:hover:text-accent transition-colors">AI Çözümlerimiz</a>
            <a href="projeler.html" class="hover:text-primary dark:hover:text-accent transition-colors">Projeler</a>
            <a href="ai-nova.html" class="text-primary dark:text-accent">AI Nova</a>
            <a href="iletisim.html" class="hover:text-primary dark:hover:text-accent transition-colors">İletişim</a>
          </nav>
        </div>
      </div>
    </header>

    <!-- Ana İçerik -->
    <main class="py-8">
      <div class="container mx-auto px-4">
        <!-- Başlık -->
        <div class="text-center mb-8">
          <div class="inline-flex items-center px-4 py-2 bg-primary/10 text-primary dark:text-accent rounded-full text-sm font-medium mb-4">
            <i class="fas fa-robot mr-2"></i>
            Yapay Zeka Asistanı
          </div>
          <h1 class="text-4xl md:text-5xl font-bold mb-4">
            <span class="gradient-text">AI Nova</span> ile Tanışın
          </h1>
          <p class="text-xl text-gray-600 dark:text-gray-300 max-w-2xl mx-auto">
            TEKNOVA'nın geliştirdiği akıllı asistan. Yapay zeka, teknoloji ve işletme sorunlarınız hakkında size yardımcı olur.
          </p>
        </div>

        <!-- Chat Container -->
        <div class="max-w-4xl mx-auto">
          <div class="bg-white dark:bg-gray-800 rounded-3xl shadow-2xl overflow-hidden ai-glow">
            <!-- Chat Header -->
            <div class="bg-gradient-to-r from-primary to-secondary p-6 text-white">
              <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                  <div class="w-12 h-12 bg-white/20 rounded-full flex items-center justify-center">
                    <i class="fas fa-robot text-xl"></i>
                  </div>
                  <div>
                    <h2 class="text-xl font-bold">AI Nova</h2>
                    <p class="text-white/80 text-sm" id="ai-status">Çevrimiçi ve hazır</p>
                  </div>
                </div>
                <div class="flex items-center gap-3">
                  <button id="clear-chat" class="p-2 hover:bg-white/20 rounded-lg transition-colors" title="Sohbeti Temizle">
                    <i class="fas fa-trash-alt"></i>
                  </button>
                </div>
              </div>
              

            </div>

            <!-- Chat Messages -->
            <div id="chat-messages" class="chat-container overflow-y-auto p-6 space-y-4">
              <!-- Karşılama Mesajı -->
              <div class="flex items-start gap-3 chat-bubble">
                <div class="w-8 h-8 bg-gradient-to-br from-primary to-secondary rounded-full flex items-center justify-center flex-shrink-0">
                  <i class="fas fa-robot text-white text-xs"></i>
                </div>
                <div class="bg-gray-100 dark:bg-gray-700 rounded-2xl rounded-tl-md p-4 max-w-xs md:max-w-md">
                  <p class="text-gray-800 dark:text-gray-200">
                    Merhaba! Ben AI Nova, TEKNOVA'nın yapay zeka asistanıyım. Size nasıl yardımcı olabilirim? 
                    Yapay zeka, teknoloji çözümleri veya TEKNOVA hakkında sorularınızı yanıtlayabilirim! 🤖
                  </p>
                </div>
              </div>
            </div>

            <!-- Chat Input -->
            <div class="border-t border-gray-200 dark:border-gray-700 p-6">
              <form id="chat-form" class="flex gap-3">
                <input 
                  type="text" 
                  id="user-input" 
                  placeholder="AI Nova'ya mesajınızı yazın..." 
                  class="flex-1 px-4 py-3 bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-2xl focus:outline-none focus:ring-2 focus:ring-primary dark:focus:ring-accent text-gray-900 dark:text-gray-100"
                  autocomplete="off"
                  maxlength="500"
                >
                <button 
                  type="button" 
                  id="voice-button"
                  class="px-4 py-3 bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white rounded-2xl transition-all transform hover:scale-105 ai-glow"
                  title="Sesli Soru Sor"
                >
                  <i class="fas fa-microphone"></i>
                </button>
                <button 
                  type="submit" 
                  id="send-button"
                  class="px-6 py-3 bg-gradient-to-r from-primary to-secondary hover:from-primary/90 hover:to-secondary/90 text-white rounded-2xl transition-all transform hover:scale-105 ai-glow disabled:opacity-50 disabled:transform-none"
                >
                  <i class="fas fa-paper-plane"></i>
                </button>
              </form>
              
              <!-- Önerilen Sorular -->
              <div class="mt-4">
                <p class="text-sm text-gray-500 dark:text-gray-400 mb-2">Önerilen sorular:</p>
                <div class="flex flex-wrap gap-2">
                  <button class="suggested-question px-3 py-1 bg-primary/10 text-primary dark:text-accent rounded-full text-sm hover:bg-primary/20 transition-colors">
                    TEKNOVA neler yapıyor?
                  </button>
                  <button class="suggested-question px-3 py-1 bg-primary/10 text-primary dark:text-accent rounded-full text-sm hover:bg-primary/20 transition-colors">
                    Yapay zeka çözümleriniz neler?
                  </button>
                  <button class="suggested-question px-3 py-1 bg-primary/10 text-primary dark:text-accent rounded-full text-sm hover:bg-primary/20 transition-colors">
                    AI projesi nasıl başlatırım?
                  </button>
                </div>
              </div>


            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Sesli Modal -->
    <div id="voice-modal" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 hidden flex items-center justify-center">
      <div class="bg-white dark:bg-gray-800 rounded-3xl p-8 shadow-2xl max-w-md w-full mx-4 text-center">
        <!-- Modal Header -->
        <div class="mb-6">
          <h3 class="text-2xl font-bold text-gray-800 dark:text-gray-200 mb-2">Sesli Soru</h3>
          <p class="text-gray-600 dark:text-gray-400 text-sm">Mikrofonunuza konuşun</p>
        </div>
        
        <!-- Ses İkonu -->
        <div class="mb-6 relative">
          <div id="voice-circle" class="w-32 h-32 mx-auto bg-gradient-to-r from-green-500 to-emerald-600 rounded-full flex items-center justify-center shadow-2xl transition-all duration-300">
            <i id="voice-icon" class="fas fa-microphone text-white text-4xl"></i>
          </div>
          <!-- Ses Dalgaları -->
          <div id="voice-waves" class="absolute inset-0 hidden">
            <div class="voice-wave absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-32 h-32 bg-green-500/30 rounded-full animate-ping"></div>
            <div class="voice-wave absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-40 h-40 bg-green-500/20 rounded-full animate-ping" style="animation-delay: 0.5s"></div>
            <div class="voice-wave absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-48 h-48 bg-green-500/10 rounded-full animate-ping" style="animation-delay: 1s"></div>
          </div>
        </div>
        
        <!-- Durum Mesajı -->
        <div class="mb-6">
          <p id="voice-status" class="text-lg font-medium text-gray-700 dark:text-gray-300">Dinleme başlatılıyor...</p>
          <p id="voice-transcript" class="text-sm text-gray-500 dark:text-gray-400 mt-2 min-h-[20px]"></p>
        </div>
        
        <!-- Kontrol Butonları -->
        <div class="flex gap-3 justify-center">
          <button id="voice-stop" class="px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white rounded-2xl transition-all transform hover:scale-105 font-medium">
            <i class="fas fa-stop mr-2"></i>Durdur
          </button>
          <button id="voice-cancel" class="px-6 py-3 bg-gray-500 hover:bg-gray-600 text-white rounded-2xl transition-all transform hover:scale-105 font-medium">
            <i class="fas fa-times mr-2"></i>İptal
          </button>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-900 text-gray-100 pt-16 pb-8">
      <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-12">
          <div>
            <div class="flex items-center gap-3 mb-4">
              <img src="teknova-logo.png" alt="TEKNOVA Logo" class="w-10 h-10 object-contain rounded-lg shadow" />
              <span class="text-2xl font-bold gradient-text">TEKNOVA</span>
            </div>
            <p class="text-gray-400 mb-4 leading-relaxed">Yapay zeka teknolojileri ile işletmeleri geleceğe hazırlıyoruz.</p>
            <div class="flex gap-4">
              <a href="#" class="text-gray-400 hover:text-primary transition-colors" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
              <a href="#" class="text-gray-400 hover:text-primary transition-colors" aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
              <a href="#" class="text-gray-400 hover:text-primary transition-colors" aria-label="GitHub"><i class="fab fa-github"></i></a>
              <a href="#" class="text-gray-400 hover:text-primary transition-colors" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
            </div>
          </div>
          
          <div>
            <h3 class="text-lg font-semibold mb-4">Çözümlerimiz</h3>
            <ul class="space-y-2">
              <li><a href="cozumlerimiz.html" class="text-gray-400 hover:text-primary transition-colors">Makine Öğrenmesi</a></li>
              <li><a href="cozumlerimiz.html" class="text-gray-400 hover:text-primary transition-colors">Bilgisayarlı Görü</a></li>
              <li><a href="cozumlerimiz.html" class="text-gray-400 hover:text-primary transition-colors">Doğal Dil İşleme</a></li>
              <li><a href="cozumlerimiz.html" class="text-gray-400 hover:text-primary transition-colors">Tahminsel Analitik</a></li>
            </ul>
          </div>
          
          <div>
            <h3 class="text-lg font-semibold mb-4">Şirket</h3>
            <ul class="space-y-2">
              <li><a href="hakkimizda.html" class="text-gray-400 hover:text-primary transition-colors">Hakkımızda</a></li>
              <li><a href="projeler.html" class="text-gray-400 hover:text-primary transition-colors">Projelerimiz</a></li>
              <li><a href="iletisim.html" class="text-gray-400 hover:text-primary transition-colors">İletişim</a></li>
              <li><a href="ai-nova.html" class="text-gray-400 hover:text-primary transition-colors">AI Nova</a></li>
            </ul>
          </div>
          
          <div>
            <h3 class="text-lg font-semibold mb-4">İletişim</h3>
            <ul class="space-y-2 text-gray-400">
              <li class="flex items-center gap-2">
                <i class="fas fa-envelope text-primary"></i>
                <span>bilgi@teknovagroup.com</span>
              </li>
              <li class="flex items-center gap-2">
                <i class="fas fa-map-marker-alt text-primary"></i>
                <span>Mevlana Mahallesi 432. Cadde No:8/23 Sincan Ankara</span>
              </li>
            </ul>
          </div>
        </div>
        
        <div class="border-t border-gray-800 pt-8 text-center">
          <p class="text-gray-400">&copy; 2025 TEKNOVA. Tüm hakları saklıdır.</p>
        </div>
      </div>
    </footer>

    <!-- JavaScript -->
    <script>
      // Tema değiştirme
      function applyTheme() {
        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
          document.documentElement.classList.add('dark');
        } else {
          document.documentElement.classList.remove('dark');
        }
      }
      applyTheme();



      // Mobil menü
      const mobileMenuBtn = document.getElementById('mobile-menu-btn');
      const mobileMenu = document.getElementById('mobile-menu');

      if (mobileMenuBtn && mobileMenu) {
        mobileMenuBtn.addEventListener('click', () => {
          mobileMenu.classList.toggle('hidden');
          const isOpen = !mobileMenu.classList.contains('hidden');
          mobileMenuBtn.setAttribute('aria-expanded', isOpen);
        });
      }

      // Chat fonksiyonları
      const chatForm = document.getElementById('chat-form');
      const userInput = document.getElementById('user-input');
      const chatMessages = document.getElementById('chat-messages');
      const sendButton = document.getElementById('send-button');
      const clearChatBtn = document.getElementById('clear-chat');
      const aiStatus = document.getElementById('ai-status');

      // TEKNOVA AI Nova - Akıllı Yanıt Sistemi
      const GEMINI_API_KEY = 'AIzaSyBvAFN4FXTp9X24x00RNI6CZO4Izixs5tY';
      
      // Gemini modelleri listesi (quota limitine göre sıralı)
      const GEMINI_MODELS = [
        'gemini-2.0-flash-lite',      // En hızlı, düşük quota
        'gemini-1.5-flash-8b',        // Hızlı ve verimli
        'gemini-2.0-flash',           // Yeni jenerasyon
        'gemini-1.5-flash',           // Stabil flash model
        'gemini-1.5-pro',             // Güçlü model
        'gemini-2.0-flash-exp-image', // Deneysel modeller
        'gemini-2.0-flash-exp-audio',
        'gemini-pro',                 // Klasik model (yedek)
      ];
      
      // API key test fonksiyonu - tüm modelleri test et
      async function testAPIConnection() {
        if (!GEMINI_API_KEY) {
          console.log('🔄 API key bulunamadı, offline modda çalışıyor');
          aiStatus.textContent = 'Offline modda çalışıyor';
          return false;
        }
        
        console.log('🔍 Gemini modellerini test ediliyor...');
        let workingModels = 0;
        
        for (const model of GEMINI_MODELS) {
          try {
            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${GEMINI_API_KEY}`, {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify({
                contents: [{
                  parts: [{text: 'Test'}]
                }]
              })
            });
            
            if (response.ok) {
              console.log(`✅ ${model} çalışıyor`);
              workingModels++;
            } else {
              console.log(`❌ ${model} quota aşıldı (${response.status})`);
            }
          } catch (error) {
            console.log(`❌ ${model} hata: ${error.message}`);
          }
        }
        
        if (workingModels > 0) {
          console.log(`🎉 ${workingModels}/${GEMINI_MODELS.length} model çalışıyor!`);
          aiStatus.textContent = `${workingModels} model aktif`;
          return true;
        } else {
          console.log('❌ Hiçbir model çalışmıyor');
          aiStatus.textContent = 'Tüm modeller quota aşıldı - Offline mod';
          return false;
        }
      }
      
      // Sayfa yüklendiğinde API'yi test et
      window.addEventListener('load', () => {
        setTimeout(testAPIConnection, 1000);
      });

      // Mesaj ekleme fonksiyonu
      function addMessage(message, isUser = false) {
        const messageDiv = document.createElement('div');
        messageDiv.className = `flex items-start gap-3 chat-bubble ${isUser ? 'justify-end' : ''}`;
        
        if (isUser) {
          messageDiv.innerHTML = `
            <div class="bg-gradient-to-r from-primary to-secondary text-white rounded-2xl rounded-tr-md p-4 max-w-xs md:max-w-md">
              <p>${message}</p>
            </div>
            <div class="w-8 h-8 bg-gray-300 dark:bg-gray-600 rounded-full flex items-center justify-center flex-shrink-0">
              <i class="fas fa-user text-gray-600 dark:text-gray-300 text-xs"></i>
            </div>
          `;
        } else {
          messageDiv.innerHTML = `
            <div class="w-8 h-8 bg-gradient-to-br from-primary to-secondary rounded-full flex items-center justify-center flex-shrink-0">
              <i class="fas fa-robot text-white text-xs"></i>
            </div>
            <div class="bg-gray-100 dark:bg-gray-700 rounded-2xl rounded-tl-md p-4 max-w-xs md:max-w-md">
              <p class="text-gray-800 dark:text-gray-200">${message}</p>
            </div>
          `;
        }
        
        chatMessages.appendChild(messageDiv);
        chatMessages.scrollTop = chatMessages.scrollHeight;
      }

      // Yazıyor göstergesi
      function showTypingIndicator() {
        const typingDiv = document.createElement('div');
        typingDiv.id = 'typing-indicator';
        typingDiv.className = 'flex items-start gap-3 chat-bubble';
        typingDiv.innerHTML = `
          <div class="w-8 h-8 bg-gradient-to-br from-primary to-secondary rounded-full flex items-center justify-center flex-shrink-0">
            <i class="fas fa-robot text-white text-xs"></i>
          </div>
          <div class="bg-gray-100 dark:bg-gray-700 rounded-2xl rounded-tl-md p-4">
            <div class="flex gap-1">
              <div class="w-2 h-2 bg-gray-400 rounded-full typing-indicator"></div>
              <div class="w-2 h-2 bg-gray-400 rounded-full typing-indicator" style="animation-delay: 0.2s"></div>
              <div class="w-2 h-2 bg-gray-400 rounded-full typing-indicator" style="animation-delay: 0.4s"></div>
            </div>
          </div>
        `;
        chatMessages.appendChild(typingDiv);
        chatMessages.scrollTop = chatMessages.scrollHeight;
      }

      function hideTypingIndicator() {
        const typingDiv = document.getElementById('typing-indicator');
        if (typingDiv) {
          typingDiv.remove();
        }
      }

      // Akıllı offline yanıt sistemi
      async function getOfflineResponse(userMessage) {
        console.log('Offline yanıt üretiliyor...');
        
        const message = userMessage.toLowerCase();
        
        // Konu kategorileri ve yanıtları
        const topicResponses = {
          'teknova': [
            'TEKNOVA, 2025 yılında kurulan yenilikçi bir yapay zeka şirketidir. Makine öğrenmesi, bilgisayarlı görü ve doğal dil işleme alanlarında araştırma ve geliştirme çalışmaları yürütüyoruz.',
            'TEKNOVA olarak, işletmelerin yapay zeka teknolojileri ile dijital dönüşümlerinde rehberlik sağlıyoruz. Yeni kurulan şirketimiz, AR-GE odaklı çalışarak sektöre değer katmayı hedefliyor.',
            'Türkiye\'de yapay zeka alanında yeni nesil çözümler geliştiren TEKNOVA, 2025\'te kurulan dinamik bir teknoloji şirketidir.'
          ],
          'yapay_zeka': [
            'Yapay zeka, makinelerin insan benzeri öğrenme ve karar verme yeteneklerini simüle eden teknolojidir. TEKNOVA olarak bu alanda çeşitli araştırmalar yapıyoruz.',
            'AI teknolojileri artık hayatımızın her alanında. TEKNOVA\'da makine öğrenmesi, derin öğrenme ve NLP konularında çalışıyoruz.',
            'Yapay zeka çözümlerimiz: Makine öğrenmesi algoritmaları, bilgisayarlı görü sistemleri ve doğal dil işleme uygulamaları.'
          ],
          'proje': [
            'TEKNOVA olarak müşterilerimizle birlikte AI projelerini hayata geçirmeyi planlıyoruz. İhtiyaç analizi ve çözüm tasarımı ile başlıyoruz.',
            'Proje geliştirme sürecimiz: İhtiyaç belirleme, teknoloji seçimi, prototyping, test ve implementasyon aşamalarından oluşur.',
            'AI proje danışmanlığı hizmetimizle, şirketinizin yapay zeka yolculuğunda size eşlik etmeyi hedefliyoruz.'
          ],
          'çözüm': [
            'Odaklandığımız AI çözüm alanları: Makine öğrenmesi, bilgisayarlı görü, doğal dil işleme ve tahminsel analitik.',
            'TEKNOVA çözümleri ile işletmenizin verilerini değerli insights\'a dönüştürmeyi hedefliyoruz.',
            'Her sektöre uygun özelleştirilmiş AI çözümleri geliştirme konusunda araştırmalar yürütüyoruz.'
          ],
          'fiyat': [
            'Proje fiyatlandırmalarımız, kapsamına ve ihtiyaçlara göre değişiklik gösterir. Ücretsiz konsültasyon ile başlayabiliriz.',
            'Esnek fiyatlandırma modelleri sunmayı planlıyoruz: Proje bazlı, retainer veya başarı fee seçenekleri.',
            'Detaylı fiyat bilgisi için lütfen iletişime geçin. Size özel bir teklif hazırlayabiliriz.'
          ],
          'iletişim': [
            'Bizimle iletişime geçmek için: info@teknova.com | +90 (212) 555-0123 | İstanbul, Türkiye',
            'TEKNOVA ile görüşmek için web sitemizdeki iletişim formunu kullanabilir veya doğrudan arayabilirsiniz.',
            'Ücretsiz konsültasyon randevusu almak için iletişim bilgilerimizi kullanın.'
          ]
        };

        // Anahtar kelime eşleştirme sistemi
        const keywords = {
          'teknova|şirket|company|kuruluş': 'teknova',
          'ai|yapay zeka|artificial|machine learning|ml|nlp|bilgisayarlı görü|computer vision': 'yapay_zeka', 
          'proje|project|başlat|geliştir|develop': 'proje',
          'çözüm|solution|hizmet|service|ürün|product': 'çözüm',
          'fiyat|ücret|maliyet|price|cost|budget|bütçe': 'fiyat',
          'iletişim|contact|ulaş|telefon|email|randevu': 'iletişim'
        };

        // En uygun kategoriyi bul
        let selectedCategory = null;
        for (const [pattern, category] of Object.entries(keywords)) {
          const regex = new RegExp(pattern, 'i');
          if (regex.test(message)) {
            selectedCategory = category;
            break;
          }
        }

        // Kategori bulunduysa ilgili yanıtı ver
        if (selectedCategory && topicResponses[selectedCategory]) {
          const responses = topicResponses[selectedCategory];
          return responses[Math.floor(Math.random() * responses.length)];
        }

        // Genel yanıtlar
        const generalResponses = [
          'Merhaba! TEKNOVA hakkında daha spesifik sorular sorabilirsiniz. Örneğin: şirketimiz, AI çözümlerimiz, projeler veya iletişim.',
          'Size daha iyi yardımcı olabilmek için sorunuzu TEKNOVA çözümleri, yapay zeka projeleri veya hizmetlerimiz hakkında daha detaylandırabilir misiniz?',
          'Ben AI Nova, TEKNOVA\'nın yapay zeka asistanıyım. Şirketimiz 2025\'te kuruldu ve AI alanında araştırmalar yapıyoruz. Hangi konuda bilgi almak istiyorsunuz?',
          'TEKNOVA olarak yapay zeka teknolojileri konusunda size yardımcı olmaya çalışıyorum. Makine öğrenmesi, bilgisayarlı görü veya projelerimiz hakkında soru sorabilirsiniz.'
        ];

        return generalResponses[Math.floor(Math.random() * generalResponses.length)];
      }

            // AI Nova Yanıt Sistemi
      async function getAIResponse(userMessage) {
        console.log('Kullanıcı mesajı:', userMessage);
        
        // Hızlı yanıt için basit anahtar kelimeler (sadece çok temel sorular)
        const quickResponses = {
          '^(merhaba|selam|hello|hi|hey)!?$': [
            'Merhaba! Ben AI Nova, TEKNOVA\'nın yapay zeka asistanıyım. Size nasıl yardımcı olabilirim? 🤖',
            'Selam! Size TEKNOVA ve AI konularında yardımcı olmak için buradayım.',
            'Merhaba! Ben AI Nova. TEKNOVA hakkında sorularınızı cevaplayabilirim.'
          ],
          '^(adın ne|adın|ismin ne|ismin|kim|kimsin)\\??$': [
            'Ben AI Nova, TEKNOVA\'nın yapay zeka asistanıyım. Size TEKNOVA çözümleri ve AI konularında yardımcı oluyorum!',
            'Adım AI Nova! TEKNOVA şirketinin AI asistanıyım.',
            'Ben AI Nova, TEKNOVA\'nın dijital asistanıyım.'
          ],
          '^(nasılsın|nasıl|naber|ne haber)\\??$': [
            'Çok iyiyim, teşekkürler! Size TEKNOVA ve AI konularında nasıl yardımcı olabilirim?',
            'Harika! TEKNOVA\'nın yapay zeka çözümleri hakkında konuşmaya hazırım.',
            'İyiyim! Size nasıl yardımcı olabilirim?'
          ]
        };

        const lowerMessage = userMessage.toLowerCase().trim();
        
        // Sadece çok basit sorular için hızlı yanıt
        for (const [pattern, responseArray] of Object.entries(quickResponses)) {
          const regex = new RegExp(pattern, 'i');
          if (regex.test(lowerMessage)) {
            console.log('Hızlı yanıt:', pattern);
            const randomResponse = responseArray[Math.floor(Math.random() * responseArray.length)];
            return randomResponse;
          }
        }

        // API key kontrolü
        if (!GEMINI_API_KEY) {
          console.log('API key yok, offline yanıt sistemi kullanılıyor...');
          return await getOfflineResponse(userMessage);
        }

        // Çoklu model denemesi - sırayla tüm modelleri dene
        console.log('Gemini modellerini sırayla deneyerek API çağrısı yapılıyor...');
        
        for (let i = 0; i < GEMINI_MODELS.length; i++) {
          const model = GEMINI_MODELS[i];
          console.log(`🔄 Model deneniyor: ${model} (${i + 1}/${GEMINI_MODELS.length})`);
          
          try {
            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${GEMINI_API_KEY}`, {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify({
                contents: [{
                  parts: [{
                    text: `Sen AI Nova adında TEKNOVA şirketinin yapay zeka asistanısın. TEKNOVA Türkiye'de yeni kurulan (2024) ve yapay zeka araştırmaları yapan bir teknoloji şirketidir. Makine öğrenmesi, bilgisayarlı görü, doğal dil işleme ve tahminsel analitik konularında çalışmalar yapıyoruz. 

ÖNEMLI KURALLAR:
- Şirketimizin yeni olduğunu (2024 kuruldu) belirt
- İddialı olmayan, mütevazi bir yaklaşım kullan
- Türkçe yanıt ver
- Maksimum 150 kelime kullan
- Dostça ve profesyonel ol
- TEKNOVA'nın AR-GE odaklı çalıştığını vurgula

Kullanıcı sorusu: ${userMessage}`
                  }]
                }],
                generationConfig: {
                  temperature: 0.7,
                  topK: 40,
                  topP: 0.95,
                  maxOutputTokens: 300,
                },
                safetySettings: [
                  {
                    category: "HARM_CATEGORY_HARASSMENT",
                    threshold: "BLOCK_MEDIUM_AND_ABOVE"
                  },
                  {
                    category: "HARM_CATEGORY_HATE_SPEECH", 
                    threshold: "BLOCK_MEDIUM_AND_ABOVE"
                  }
                ]
              })
            });

            if (response.ok) {
              const data = await response.json();
              console.log(`✅ ${model} başarıyla yanıt verdi:`, data);
              
              if (data.candidates && data.candidates[0] && data.candidates[0].content && data.candidates[0].content.parts[0]) {
                const aiResponse = data.candidates[0].content.parts[0].text;
                console.log(`🎉 AI yanıtı ${model} modelinden alındı:`, aiResponse);
                return aiResponse;
              }
            } else {
              console.warn(`⚠️ ${model} modeli hata verdi (${response.status}): ${response.statusText}`);
              
              // 429 (Rate limit) veya 400 hatası ise bir sonraki modeli dene
              if (response.status === 429 || response.status === 400 || response.status === 403) {
                console.log(`🔄 ${model} quota/limit aşıldı, sonraki modele geçiliyor...`);
                continue;
              } else {
                throw new Error(`HTTP error! status: ${response.status}`);
              }
            }
          } catch (error) {
            console.error(`❌ ${model} modeli hatası:`, error);
            
            // Son model değilse bir sonrakini dene
            if (i < GEMINI_MODELS.length - 1) {
              console.log(`🔄 ${model} başarısız, sonraki modele geçiliyor...`);
              continue;
            }
          }
        }
        
        // Tüm modeller başarısız oldu - offline yanıt sistemine geç
        console.error('❌ Tüm Gemini modelleri başarısız oldu, offline moda geçiliyor');
        return await getOfflineResponse(userMessage);
      }

      // Form gönderimi
      if (chatForm) {
        chatForm.addEventListener('submit', async (e) => {
          e.preventDefault();
          console.log('Form gönderildi');
          
          const message = userInput.value.trim();
          console.log('Mesaj:', message);
          if (!message) return;

          // Kullanıcı mesajını ekle
          addMessage(message, true);
          userInput.value = '';
          
          // UI durumunu güncelle
          sendButton.disabled = true;
          aiStatus.textContent = 'Yazıyor...';
          showTypingIndicator();

          try {
            // AI yanıtını al
            console.log('AI yanıtı alınıyor...');
            const response = await getAIResponse(message);
            console.log('AI yanıtı:', response);
            
            // Yazıyor göstergesini kaldır ve yanıtı ekle
            hideTypingIndicator();
            addMessage(response);
          } catch (error) {
            console.error('Hata:', error);
            hideTypingIndicator();
            addMessage('Üzgünüm, bir hata oluştu. Lütfen tekrar deneyin.');
          } finally {
            sendButton.disabled = false;
            aiStatus.textContent = 'Çevrimiçi ve hazır';
          }
        });
      } else {
        console.error('Chat form bulunamadı!');
      }

      // Önerilen sorular
      document.querySelectorAll('.suggested-question').forEach(button => {
        button.addEventListener('click', () => {
          userInput.value = button.textContent;
          chatForm.dispatchEvent(new Event('submit'));
        });
      });

      // Sohbeti temizle
      clearChatBtn.addEventListener('click', () => {
        if (confirm('Sohbet geçmişini temizlemek istediğinizden emin misiniz?')) {
          chatMessages.innerHTML = `
            <div class="flex items-start gap-3 chat-bubble">
              <div class="w-8 h-8 bg-gradient-to-br from-primary to-secondary rounded-full flex items-center justify-center flex-shrink-0">
                <i class="fas fa-robot text-white text-xs"></i>
              </div>
              <div class="bg-gray-100 dark:bg-gray-700 rounded-2xl rounded-tl-md p-4 max-w-xs md:max-w-md">
                <p class="text-gray-800 dark:text-gray-200">
                  Merhaba! Ben AI Nova, TEKNOVA'nın yapay zeka asistanıyım. Size nasıl yardımcı olabilirim? 
                  Yapay zeka, teknoloji çözümleri veya TEKNOVA hakkında sorularınızı yanıtlayabilirim! 🤖
                </p>
              </div>
            </div>
          `;
        }
      });

      // Enter tuşu ile gönderme
      userInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter' && !e.shiftKey) {
          e.preventDefault();
          chatForm.dispatchEvent(new Event('submit'));
        }
      });

      // Sesli İnteraksiyon Sistemi
      let recognition = null;
      let isListening = false;
      let speechSynthesis = window.speechSynthesis;

      // Modal elementleri
      const voiceModal = document.getElementById('voice-modal');
      const voiceButton = document.getElementById('voice-button');
      const voiceStop = document.getElementById('voice-stop');
      const voiceCancel = document.getElementById('voice-cancel');
      const voiceStatus = document.getElementById('voice-status');
      const voiceTranscript = document.getElementById('voice-transcript');
      const voiceCircle = document.getElementById('voice-circle');
      const voiceIcon = document.getElementById('voice-icon');
      const voiceWaves = document.getElementById('voice-waves');

      // Web Speech API Desteği Kontrolü
      function initializeSpeechRecognition() {
        if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
          const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
          recognition = new SpeechRecognition();
          
          recognition.continuous = false;
          recognition.interimResults = true;
          recognition.lang = 'tr-TR';
          recognition.maxAlternatives = 1;

          recognition.onstart = function() {
            console.log('🎤 Ses tanıma başladı');
            isListening = true;
            voiceStatus.textContent = 'Dinliyorum... Konuşun!';
            voiceIcon.className = 'fas fa-microphone-slash text-white text-4xl';
            voiceCircle.classList.add('voice-recording');
            voiceWaves.classList.remove('hidden');
          };

          recognition.onresult = function(event) {
            let finalTranscript = '';
            let interimTranscript = '';

            for (let i = event.resultIndex; i < event.results.length; i++) {
              const result = event.results[i];
              if (result.isFinal) {
                finalTranscript += result[0].transcript;
              } else {
                interimTranscript += result[0].transcript;
              }
            }

            const transcript = finalTranscript || interimTranscript;
            voiceTranscript.textContent = transcript;

            if (finalTranscript) {
              console.log('🗣️ Final transcript:', finalTranscript);
              processSpeechInput(finalTranscript.trim());
            }
          };

          recognition.onerror = function(event) {
            console.error('❌ Ses tanıma hatası:', event.error);
            let errorMessage = 'Ses tanıma hatası oluştu.';
            
            switch(event.error) {
              case 'network':
                errorMessage = 'İnternet bağlantısı sorunu.';
                break;
              case 'not-allowed':
                errorMessage = 'Mikrofon izni reddedildi.';
                break;
              case 'no-speech':
                errorMessage = 'Ses algılanamadı. Tekrar deneyin.';
                break;
              case 'audio-capture':
                errorMessage = 'Mikrofon bulunamadı.';
                break;
            }
            
            voiceStatus.textContent = errorMessage;
            setTimeout(closeVoiceModal, 2000);
          };

          recognition.onend = function() {
            console.log('🔇 Ses tanıma sona erdi');
            isListening = false;
            resetVoiceUI();
          };

          return true;
        }
        return false;
      }

      // Ses girişini işleme
      async function processSpeechInput(transcript) {
        if (!transcript) return;

        console.log('🗣️ Ses girişi işleniyor:', transcript);
        closeVoiceModal();
        
        // Kullanıcı mesajını chat'e ekle
        addMessage(transcript, true);
        
        // AI yanıtını al
        try {
          aiStatus.textContent = 'Yazıyor...';
          showTypingIndicator();
          
          const response = await getAIResponse(transcript);
          
          hideTypingIndicator();
          addMessage(response);
          
          // Sesli yanıt ver
          speakResponse(response);
          
        } catch (error) {
          console.error('❌ AI yanıt hatası:', error);
          hideTypingIndicator();
          const errorMsg = 'Üzgünüm, bir hata oluştu. Lütfen tekrar deneyin.';
          addMessage(errorMsg);
          speakResponse(errorMsg);
        } finally {
          aiStatus.textContent = 'Çevrimiçi ve hazır';
        }
      }

      // Sesli yanıt
      function speakResponse(text) {
        // Mevcut konuşmaları durdur
        speechSynthesis.cancel();
        
        // Metni temizle (HTML tagları vs.)
        const cleanText = text.replace(/<[^>]*>/g, '').replace(/[🤖🎉✅❌🔄]/g, '');
        
        if (cleanText.trim()) {
          // Google Text-to-Speech API kullan
          playGoogleTTS(cleanText);
        }
      }

      // AI Nova'nın Özel Ses Sistemi
      async function playGoogleTTS(text) {
        console.log('🎭 AI Nova\'nın kendine özel sesi aktifleştiriliyor...');
        aiStatus.textContent = 'AI Nova konuşuyor...';
        
        // AI Nova için özelleştirilmiş ses çalma
        playAINovaVoice(text);
      }

      // AI Nova Özel Ses Karakteri
      function playAINovaVoice(text) {
        console.log('🤖 AI Nova\'nın kendine özgü sesi kullanılıyor...');
        
        const utterance = new SpeechSynthesisUtterance(text);
        
        // AI Nova'ya özel ses karakteristikleri
        utterance.lang = 'tr-TR';
        utterance.rate = 0.88;     // Biraz yavaş ve ölçülü
        utterance.pitch = 1.15;    // Hafif yüksek, dostça ton
        utterance.volume = 0.85;   // Net ve rahat duyulur seviye
        
        // AI Nova için en uygun sesi bul
        const voices = speechSynthesis.getVoices();
        let aiNovaVoice = null;
        
        // Tercih sırası: Doğal > Neural > Standart
        const voicePreferences = [
          // En kaliteli seçenekler (Neural/Natural)
          'Microsoft Emel Online (Natural) - Turkish (Turkey)',
          'tr-TR-EmelNeural',
          'Microsoft Emel - Turkish (Turkey)',
          
          // Google'ın kaliteli sesleri
          'Google Türkçe',
          'Google tr-TR',
          
          // Standart seçenekler
          'tr-TR-Standard-E',    // Kadın
          'tr-TR-Standard-A',    // Kadın
          'tr-TR-Wavenet-E',     // Kadın Neural
          'tr-TR-Wavenet-A',     // Kadın Neural
          
          // Yedek seçenekler
          'Turkishh Female',
          'Turkish Female'
        ];
        
        // En iyi sesi bul
        for (const preferredName of voicePreferences) {
          aiNovaVoice = voices.find(voice => {
            const voiceName = voice.name.toLowerCase();
            const preferredLower = preferredName.toLowerCase();
            return voiceName.includes(preferredLower) || 
                   voiceName === preferredLower ||
                   (voice.lang === 'tr-TR' && voice.name.includes('Female'));
          });
          
          if (aiNovaVoice) {
            console.log(`✨ AI Nova'nın sesi seçildi: ${aiNovaVoice.name}`);
            break;
          }
        }
        
        // Ses bulunamazsa Türkçe kadın sesi ara
        if (!aiNovaVoice) {
          aiNovaVoice = voices.find(voice => 
            voice.lang && voice.lang.startsWith('tr') && 
            (voice.name.toLowerCase().includes('female') || 
             voice.name.toLowerCase().includes('kadın') ||
             voice.name.toLowerCase().includes('emel'))
          );
        }
        
        // Son çare: herhangi bir Türkçe ses
        if (!aiNovaVoice) {
          aiNovaVoice = voices.find(voice => 
            voice.lang && voice.lang.startsWith('tr')
          );
        }
        
        if (aiNovaVoice) {
          utterance.voice = aiNovaVoice;
          console.log(`🗣️ AI Nova konuşuyor: ${aiNovaVoice.name} (${aiNovaVoice.lang})`);
        } else {
          console.warn('⚠️ Türkçe ses bulunamadı, varsayılan ses kullanılıyor');
        }
        
        // AI Nova'nın konuşma olayları
        utterance.onstart = function() {
          console.log('🎤 AI Nova konuşmaya başladı');
          aiStatus.textContent = '🤖 AI Nova konuşuyor...';
          
          // Ses sırasında görsel efekt
          const aiIcon = document.querySelector('#ai-status');
          if (aiIcon) {
            aiIcon.style.animation = 'pulse 1s infinite';
          }
        };
        
        utterance.onend = function() {
          console.log('✅ AI Nova konuşmasını tamamladı');
          aiStatus.textContent = 'Çevrimiçi ve hazır';
          
          // Animasyonu durdur
          const aiIcon = document.querySelector('#ai-status');
          if (aiIcon) {
            aiIcon.style.animation = '';
          }
        };
        
        utterance.onerror = function(event) {
          console.error('❌ AI Nova ses hatası:', event.error);
          aiStatus.textContent = 'Ses hatası - Çevrimiçi ve hazır';
          
          const aiIcon = document.querySelector('#ai-status');
          if (aiIcon) {
            aiIcon.style.animation = '';
          }
        };
        
        // Konuşmayı başlat
        speechSynthesis.speak(utterance);
      }

      

      // Modal açma
      function openVoiceModal() {
        if (!recognition) {
          alert('Üzgünüm, tarayıcınız ses tanıma özelliğini desteklemiyor. Chrome veya Edge kullanmayı deneyin.');
          return;
        }

        voiceModal.classList.remove('hidden');
        voiceStatus.textContent = 'Mikrofon izni bekleniyor...';
        voiceTranscript.textContent = '';
        
        // Ses tanımayı başlat
        setTimeout(() => {
          try {
            recognition.start();
          } catch (error) {
            console.error('❌ Ses tanıma başlatma hatası:', error);
            voiceStatus.textContent = 'Ses tanıma başlatılamadı.';
            setTimeout(closeVoiceModal, 2000);
          }
        }, 500);
      }

      // Modal kapatma
      function closeVoiceModal() {
        voiceModal.classList.add('hidden');
        if (recognition && isListening) {
          recognition.stop();
        }
        resetVoiceUI();
      }

      // Ses UI'ını sıfırla
      function resetVoiceUI() {
        voiceIcon.className = 'fas fa-microphone text-white text-4xl';
        voiceCircle.classList.remove('voice-recording');
        voiceWaves.classList.add('hidden');
        voiceStatus.textContent = 'Dinleme başlatılıyor...';
        voiceTranscript.textContent = '';
      }

      // Event Listeners
      voiceButton.addEventListener('click', openVoiceModal);
      voiceStop.addEventListener('click', closeVoiceModal);
      voiceCancel.addEventListener('click', closeVoiceModal);

      // Modal dışına tıklayınca kapatma
      voiceModal.addEventListener('click', (e) => {
        if (e.target === voiceModal) {
          closeVoiceModal();
        }
      });

      // ESC tuşu ile kapatma
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && !voiceModal.classList.contains('hidden')) {
          closeVoiceModal();
        }
      });

      // Sayfa yüklendiğinde ses tanıma özelliğini başlat
      window.addEventListener('load', () => {
        const speechSupported = initializeSpeechRecognition();
        if (!speechSupported) {
          console.warn('⚠️ Ses tanıma desteklenmiyor');
          voiceButton.style.display = 'none';
        } else {
          console.log('✅ Ses tanıma hazır');
        }
        
        // Sesler yüklendiğinde Türkçe sesi ayarla
        if (speechSynthesis.onvoiceschanged !== undefined) {
          speechSynthesis.onvoiceschanged = function() {
            console.log('🔊 Sesler yüklendi:', speechSynthesis.getVoices().length);
          };
        }
      });
    </script>
</body>
</html>